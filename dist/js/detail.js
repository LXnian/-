"use strict";var liData,_createClass=function(){function n(t,i){for(var o=0;o<i.length;o++){var n=i[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,i,o){return i&&n(t.prototype,i),o&&n(t,o),t}}();function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function getProductId(){var t=location.href;return t.substring(t.indexOf("?")+1).split("=")[1]}function getProductDetail(){var t=getProductId();$.ajax({method:"get",url:"http://api.yuguoxy.com/api/shop/find",data:{id:t},success:function(t){showProductDetail(t.resultInfo),addCart(t.resultInfo)}})}function showProductDetail(t){var i=t.list.map(function(t){return'<li><img src="'+t+'" alt=""></li>'}).join(""),o=' <div class="show">\n                        <img src="'+t.picture+'" alt="" class=\'big\'>\n                        <div class="mask"></div>\n                     </div>\n                    <ul class=\'small\'>'+i+"</ul>",n='<div class="bigshow">\n                        <img src="'+t.picture+'" alt="" class=\'big\'>\n                    </div>\n                    <h2>'+t.shop+"</h2>\n                    <p class='productName'>"+t.product+"</p>\n                    <p class='price'>价格：<span>￥"+t.price+"</span></p>",e=' <img src="'+t.list[0]+'" alt="">',t=' <img src="'+t.list[1]+'" alt="">',o=($("#main .left").html(o),$("#main .right .top").html(n),$("#main .right .bottom .choiceone").html(e),$("#main .right .bottom .choicetwo").html(t),$("#detailpage").html('<p>商品详情</p><img src="'+i+'" alt="">'),new Glass("#main"));o.onGlass(),o.onTab(),productNum()}function productNum(){$("#main .right .bottom .num").on("click",'input[name="plus"]',function(){var t=$('#main .right .bottom .num input[name="amount"]').val();$('#main .right .bottom .num input[name="amount"]').val(++t),"0"!=$('#main .right .bottom .num input[name="amount"]').val()&&$('#main .right .bottom .num input[name="minus"]').removeAttr("disabled")}),$("#main .right .bottom .num").on("click",'input[name="minus"]',function(t){var i=$('#main .right .bottom .num input[name="amount"]').val();$('#main .right .bottom .num input[name="amount"]').val(--i),"0"==$('#main .right .bottom .num input[name="amount"]').val()&&$(this).attr("disabled","true")})}var Glass=function(){function i(t){_classCallCheck(this,i),this.rootEle=document.querySelector(t),this.mask=this.rootEle.querySelector(".mask"),this.showBox=this.rootEle.querySelector(".show"),this.glassBox=this.rootEle.querySelector(".bigshow"),this.bigPic=this.rootEle.querySelector(".bigshow>img"),this.lis=this.rootEle.querySelectorAll("li")}return _createClass(i,[{key:"setScale",value:function(){var t=parseInt(this.showBox.clientWidth*this.glassBox.clientWidth/this.mask.clientWidth),i=parseInt(this.showBox.clientHeight*this.glassBox.clientHeight/this.mask.clientHeight);this.bigPic.style.width=t+"px",this.bigPic.style.height=i+"px"}},{key:"onGlass",value:function(){var o=this;this.showBox.addEventListener("mouseover",function(t){o.glassBox.style.display="block",o.mask.style.display="block",o.setScale()}),this.showBox.addEventListener("mousemove",function(t){var i=(t=t||window.event).offsetX-o.mask.clientWidth/2,t=t.offsetY-o.mask.clientHeight/2,i=((i=i<0?0:i)>o.showBox.clientWidth-o.mask.clientWidth&&(i=o.showBox.clientWidth-o.mask.clientWidth),(t=t<0?0:t)>o.showBox.clientHeight-o.mask.clientHeight&&(t=o.showBox.clientHeight-o.mask.clientHeight),o.mask.style.left=i+"px",o.mask.style.top=t+"px",i*o.glassBox.clientWidth/o.mask.clientWidth),t=t*o.glassBox.clientHeight/o.mask.clientHeight;o.bigPic.style.left=-i+"px",o.bigPic.style.top=-t+"px"}),this.showBox.addEventListener("mouseout",function(t){o.mask.style.display="none",o.glassBox.style.display="none"})}},{key:"onTab",value:function(){$(".small").on("click","img",function(){$(".show img").prop("src",$(this).prop("src")),$(".bigshow>img").prop("src",$(this).prop("src"))})}}]),i}();function getbigBox(){$(".show").hover(function(){$(".bigshow").prop("display","block")})}function addCart(n){$(".add-cart").on("click",function(){var i=void 0,o=getProductId(),t=JSON.parse(localStorage.getItem("CART-LIST"))||[];t.forEach(function(t){t.id==o&&(t.putaway=Number(t.putaway)+Number($('#main .right .bottom .num input[name="amount"]').val()),i=1)}),1!=i&&t.push(n),localStorage.setItem("CART-LIST",JSON.stringify(t)),location.href="../pages/cart.html"})}getbigBox(),getProductDetail();